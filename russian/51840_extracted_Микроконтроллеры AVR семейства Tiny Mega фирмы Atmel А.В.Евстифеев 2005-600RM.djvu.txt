Глава 11. Прерывания 
ATmega8x и ATmega8515x используются команды RJMP, а в остальных  
моделях — команды JMP. 
Практически во всех микроконтроллерах семейства Mega, за  
исключением моделей ATmegal61x и ATmegal63x, положение таблицы векторов 
прерываний может быть изменено. Таблица может располагаться не только 
в начале памяти программ, а также и в начале области загрузчика. Причем 
перемещение таблицы может быть осуществлено непосредственно в ходе 
выполнения программы. 
Управление размещением таблицы прерываний осуществляется двумя 
младшими разрядами регистров MCUCR (модели ATmega64x и АТ- 
megal28x) и GICR (остальные модели): IVSEL A-й разряд) и IVCE @-й  
разряд). Состояние флага FVSEL определяет положение таблицы в памяти  
программ. Если флаг сброшен в «0», таблица векторов прерываний 
располагается в начале памяти программ, если флаг установлен в «1» — в  
начале области загрузчика. Конкретное значение начального адреса области 
загрузчика зависит от установок конфигурационных ячеек BOOTSZ1 и 
BOOTSZ0 (кроме моделей ATmegal61x). Разряд FVCE предназначен для 
разрешения изменения флага FVSEL. 
Для изменения положения таблицы векторов прерываний необходимо 
установить разряд FVCE в «1» и затем в течение следующих четырех  
машинных циклов занести требуемое значение в разряд FVSEL При этом разряд 
IVCE сбрасывается в «0». В противном случае разряд IVCE будет сброшен 
аппаратно по истечении четырех машинных циклов, запрещая дальнейшее 
изменение флага FVSEL 
На время выполнения описанной последовательности прерывания  
автоматически запрещаются и разрешаются только после сброса флага ГУСЕ. 
Состояние флага I регистра SREG при этом не меняется. 
Размер таблицы зависит от модели микроконтроллера и составляет от 16 
(модели ATmega8515x) до 34 (модели ATmega64x и ATmegal28x) векторов. 
Распределение адресов таблицы векторов прерываний для различных  
микроконтроллеров семейства приведено в Табл. 2.54...2.62. При размещении 
векторов прерываний в области загрузчика к значениям, указанным в  
таблицах, следует прибавить значение начального адреса области загрузчика. 
Обратите внимание на то, что таблица векторов прерываний моделей АТ- 
megal62x зависит от состояния конфигурационной ячейки М161С,  
определяющей режим функционирования микроконтроллера. При  
запрограммированной ячейке (в режиме совместимости с ATmegal61x) количество 
векторов прерываний уменьшается, поскольку часть периферийных  
устройств в этом режиме не поддерживается. 
-231- 
