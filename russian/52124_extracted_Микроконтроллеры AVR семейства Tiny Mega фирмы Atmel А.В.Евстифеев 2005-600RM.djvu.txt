Глава 25. Программирование по интерфейсу JTAG 
ный выход, то его содержимое фиксируется на нем при  
прохождении состояния «Update-DR». 
Остается только добавить, что независимо от начального состояния 
ТАР-контроллера он всегда возвращается в состояние 
«Test-Logic-Reset» после удержания на выводе TMS сигнала лог. 1 в  
течение 5 периодов сигнала ТСК. 
25.2. Использование интерфейса JTAG для 
программирования кристалла. Команды JTAG 
Разрешение/запрещение интерфейса JTAG (причем не только для 
программирования) осуществляется конфигурационной ячейкой 
JTAGEN. Если она не запрограммирована («1»), выводы ТАР работают 
как обычные контакты портов ввода/вывода, а ТАР-контроллер  
находится в состоянии сброса. Для включения интерфейса ячейка JTAGEN 
должна быть запрограммирована (состояние по умолчанию). Кроме 
того, должен быть сброшен разряд JTD регистра управления MCUCSR 
(Рис. 4.16). Сброс этого разряда может быть осуществлен как про- 
граммно, записью в этот разряд лог. О, так и аппаратно, подачей на  
вывод RESET напряжения НИЗКОГО уровня. Причем для программного 
изменения состояния этого разряда новое значение в него необходимо 
записать дважды в течение 4-х машинных циклов. 
Рис. 4.16. Регистр MCUCSR применительно к интерфейсу JTAG 
Описанный механизм позволяет использовать выводы ТАР как 
в качестве контактов портов ввода/вывода при нормальном  
функционировании микроконтроллера, так и в качестве выводов собственно 
порта JTAG при программировании кристалла. Разумеется, этот  
механизм не применим в том случае, если порт JTAG используется для  
отладки или тестирования. 
Из 16 команд, поддерживаемых интерфейсом, при  
программировании используются только пять. Описания этих команд 
приведены далее. 
-517- 
