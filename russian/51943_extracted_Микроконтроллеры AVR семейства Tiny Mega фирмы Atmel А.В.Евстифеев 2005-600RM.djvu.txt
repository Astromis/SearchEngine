Глава 16. Универсальный асинхронный приемопередатчик 
значение регистра UBRRH (UBRRHaj). При повторном обращении по этим 
адресам в следующем машинном цикле возвращается значение регистра 
UCSRC (UCSRaiC), как показано в приведенных ниже примерах. 
Прерывания при выполнении этой последовательности команд должны 
быть запрещены. 
Пример на ассемблере 
USART_ReadUCSRC: 
;Прочитать регистр UCSRC 
in rl6,UBRRH 
in rl6,UCSRC 
ret /Значение регистра UCSRC возвращается 
в регистре г16 
Пример на С 
unsigned char USART_ReadUCSRC(void) 
{ 
unsigned char ucsrc; 
ucsrc = UBRRH; 
ucsrc = UCSRC; 
return ucsrc; 
} 
При работе в асинхронном режиме скорость обмена определяется 
не только содержимым регистра UBRR, но и состоянием разряда U2X 
(ШХл) регистра UCSRA (UCSRwA). Если этот разряд установлен в «1», 
коэффициент деления предцелителя уменьшается в два раза, а скорость 
обмена соответственно удваивается. При работе в синхронном режиме этот 
разряд должен быть сброшен. 
Итак, скорость обмена определяется следующими формулами, где 
BAUD — скорость передачи в бодах, /ск — тактовая частота  
микроконтроллера, UBRR — содержимое регистра контроллера скорости передачи @...4095): 
• асинхронный режим (обычный, ШХя = «О») 
BAUD=/CK/16(UBRR+1); 
• асинхронный режим (ускоренный, U2X/I = «1») 
BAUD=/CK/8(UBRR+1); 
• синхронный режим ведущего 
BAUD=/CK/2(UBRR+1). 
В качестве примера в Табл. 2.129 приведены значения регистра UBRR, 
позволяющие получить стандартные для асинхронного режима скорости 
передачи при использовании различных резонаторов, а также величины 
ошибок получаемых значений относительно стандартных. 
-335- 
