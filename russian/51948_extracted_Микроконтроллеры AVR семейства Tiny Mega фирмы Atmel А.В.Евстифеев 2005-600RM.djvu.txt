Глава 16. Универсальный асинхронный приемопередатчик 
вход независимо от установок регистров управления портом. Если  
используется синхронный режим работы (в USART), переопределяется также 
функционирование вывода ХСК (ХСКя). 
Прием данных начинается сразу же после обнаружения приемником 
корректного старт-бита. Каждый разряд содержимого кадра затем считыва- 
ется с частотой, определяемой установками контроллера скорости передачи 
или тактовым сигналом ХСК (ХСКя). Считанные разряды данных  
последовательно помещаются в сдвиговый регистр приемника до обнаружения  
первого стоп-бита кадра. После этого содержимое сдвигового регистра  
пересылается в буфер приемника, из которого принятое значение может быть 
получено путем чтения регистра данных модуля. При использовании  
9-разрядных слов данных значение старшего разряда может быть определено по 
состоянию флага RX8 (RX8/7) регистра UCSRB (UCSR/7B). Причем в  
модулях USART содержимое старшего разряда данных должно быть считано до 
обращения к регистру данных. Это связано с тем, что флаг RX8 (RX8/7)  
отображает значение старшего разряда слова данных кадра, находящегося на 
верхнем уровне буфера приемника, состояние которого при чтении  
регистра данных изменится. 
Если во время приема кадра была включена схема контроля четности 
(только USART), она вычисляет бит четности для всех разрядов принятого 
слова данных и сравнивает его с принятым битом четности. Результат  
проверки запоминается в буфере приемника вместе с принятым словом данных 
и стоп-битами. Наличие или отсутствие ошибки контроля четности может 
быть затем определено по состоянию флага UPE (UPEn). Этот флаг  
устанавливается в «1», если следующее слово, которое может быть прочитано из 
буфера, имеет ошибку контроля четности. При выключенном контроле  
четности флаг UPE (UPE/7) всегда читается как «О». 
Блок приемника модулей USART/UART имеет еще два флага,  
показывающих состояние обмена: флаг ошибки кадрирования FE (FEn) и флаг  
переполнения DOR (DOR/7 )/OR (OR/7). Флаг FE (FEn) устанавливается в «1», 
если значение первого стоп-бита принятого кадра не соответствует 
требуемому, т. е. равно «О». 
Флаги DOR (DOR/7) в USART и OR (OR/*) в UART индицируют потерю 
данных из-за переполнения буфера приемника. В UART флаг 
устанавливается в «1», если к моменту окончания приема кадра (заполнения 
сдвигового регистра приемника) данные предьщущего кадра не были 
считаны из регистра данных. В USART флаг устанавливается в «1» в случае 
приема старт-бита нового кадра при заполненных буфере и сдвиговом 
регистре приемника. Установленный флаг DOR (DOR/7)/OR (OR/7) 
означает, что между прошлым байтом, считанным из регистра UDR, и 
байтом, считанным в данный момент, произошла потеря одного или 
нескольких кадров. 
-341- 
