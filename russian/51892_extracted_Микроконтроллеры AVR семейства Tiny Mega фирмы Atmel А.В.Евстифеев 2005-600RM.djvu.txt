Глава 13. Таймеры 
ние которого — сохранение в определенный момент времени  
состояния таймера/счетчика в регистре захвата ICR1 (ICR3). Это действие 
может производиться либо по активному фронту сигнала на выводе 
ICP1 (ICP3) микроконтроллера, либо (для таймера/счетчика Т1) по 
сигналу от аналогового компаратора. Одновременно с записью в  
регистр захвата устанавливается флаг ICF1 регистра TIFR (ICF3 регистра 
ETIFR) и генерируется запрос на прерывание. Разрешение прерывания 
осуществляется установкой в «1» разряда TICIE1 регистра TIMSK 
(TICIE3 регистра ETIMSK). Программно запись в регистр ICR1 (ICR3) 
возможна только в режимах, в которых регистр захвата определяет  
модуль счета таймера/счетчика (Табл. 2.93). Вывод ICP1 (ICP3) в этих  
режимах отключен и функция захвата, соответственно, выключена. 
Упрощенная структурная схема блока захвата приведена на Рис. 2.76. 
* Выход аналогового компаратора может влиять только на таймер/счетчик Т1. 
Рис. 2.76. Структурная схема блока захвата 
Для управления схемой захвата используются два разряда регистра 
TCCR1B (TCCR3B) - ICNC1 (ICNC3) и ICES1 (ICES3). Разряд ICNC1 
(ICNC3) управляет схемой подавления помех. Если этот разряд сброшен в 
«О», схема подавления помех выключена и захват производится по первому 
же активному фронту на выходе мультиплексора (Рис. 2.76). Если же этот 
разряд установлен в «1», то при появлении активного фронта производится 
4 выборки с частотой, равной тактовой частоте микроконтроллера. Захват 
будет выполнен только в том случае, если все выборки имеют уровень,  
соответствующий активному фронту сигнала (лог. 1 для нарастающего и лог. О 
для спадающего). 
-283- 
