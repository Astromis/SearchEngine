Часть 1. Микроконтроллеры семейства Tiny 
Таблица 1.51. Разряды регистра ADCSR 
Разряд 
7 
6 
5 
4 
3 
2...0 
Название 
ADEN 
ADSC 
ADFR 
ADIF 
ADIE 
ADPS2:ADPS0 
Описание 
Разрешение АЦП («1» — включено, «0» — выключено) 
Запуск преобразования («1» — начать преобразование) 
Выбор режима работы АЦП («0» — одиночное преобразование) 
Флаг прерывания от компаратора 
Разрешение прерывания от компаратора 
Выбор частоты преобразования 
Для разрешения работы АЦП необходимо записать лог. 1 в разряд 
ADEN регистра ADCSR, а для выключения соответственно лог. 0. 
Причем, если АЦП будет выключено во время цикла преобразования, 
то преобразование завершено не будет (в регистре данных АЦП  
останется результат предыдущего преобразования). 
Режим работы АЦП определяется состоянием разряда ADFR. Если 
он установлен в «1», АЦП работает в режиме непрерывного  
преобразования. В этом режиме запуск каждого следующего преобразования 
осуществляется автоматически после окончания текущего. Если же 
разряд ADFR сброшен в «О», АЦП работает в режиме одиночного  
преобразования и запуск каждого преобразования осуществляется по  
команде пользователя. 
Запуск каждого преобразования в режиме одиночного  
преобразования, а также запуск первого преобразования в режиме непрерывного 
преобразования осуществляется установкой в «1» разряда ADSC  
регистра ADCSR. Собственно цикл преобразования начинается по  
первому нарастающему фронту тактового сигнала после установки этого 
разряда. Как правило, длительность цикла составляет 13 тактов;  
выборка и запоминание входного сигнала осуществляется в течение  
первых 1.5 тактов. Через 13 тактов преобразование завершается, разряд 
ADSC аппаратно сбрасывается в «0» (в режиме одиночного  
преобразования) и результат преобразования сохраняется в регистре данных 
АЦП. Одновременно устанавливается флаг прерывания ADIF регистра 
ADCSR и генерируется запрос на прерывание. Как и флаги остальных 
прерываний, флаг ADIF сбрасывается аппаратно при запуске  
подпрограммы обработки прерывания от АЦП или программно, записью в 
него лог. 1. Разрешение прерывания осуществляется установкой в «1» 
разряда ADIE регистра ADCSR при установленном флаге I регистра 
SREG. 
Если АЦП работает в режиме непрерывного преобразования,  
новый цикл начнется сразу же после записи результата. В режиме  
одиночного преобразования новое преобразование может быть запущено 
—106 — 
