Глава 2. Архитектура микроконтроллеров 
гистр используется для управления доступом к EEPROM-памяги. Формат 
этого регистра показано на Рис. 1.19, а его описание приведено в Т&бл. 1.10. 
Рис. 1.20. Формат регистра EECR 
Таблица 1.10. Разряды регистра EECR 
Разряд 
1..Л 
3 
2 
1 
0 
Название 
- 
EERIE 
EEMWE 
EEWE 
EERE 
Описание 
Не используются, читаются как «0» 
Разрешение прерывания от EEPROM. Данный разряд управляет генерацией 
прерывания, возникающего при завершении цикла записи в EEPROM. Если 
этот разряд установлен в «1», прерывания разрешены (если флаг I регистра 
SREG также установлен в «1»). При сброшенном разряде EEWE (см. далее в 
таблице) прерывание генерируется постоянно 
Управление разрешением записи в EEPROM. Состояние этого разряда  
определяет функционирование флага разрешения записи EEWE. Если данный  
разряд установлен в «1», то при записи в разряд EEWE «1» происходит запись 
данных в EEPROM. В противном случае установка EEWE в «1» не производит 
никакого эффекта. После программной установки этот разряд сбрасывается 
аппаратно через 4 машинных цикла 
Разрешение записи в EEPROM. При установке этого разряда в «1» происходит 
запись данных в EEPROM (если EEMWE равен «1») 
Разрешение чтения из EEPROM. После установки этого разряда в «1»  
выполняется чтение данных из EEPROM. По окончании чтения этот разряд  
сбрасывается аппаратно 
Таким образом, процедура записи одного байта в EEPROM-память 
состоит из следующих этапов: 
• дождаться готовности EEPROM к записи данных (ждать пока не 
сбросится флаг EEWE (EEPROM Write Enable) регистра EECR); 
• загрузить байт данных в регистр EEDR, а требуемый адрес — в  
регистр EEAR; 
• установить в «1» флаг EEMWE (EEPROM Memory Write Enable) 
регистра EECR; 
• в течение 4-х машинных циклов после установки флага EEMWE 
записать «1» в разряд EEWE регистра EECR. 
Длительность цикла записи зависит от частоты внутреннего /?С-ге- 
нератора (от значения калибровочной константы) и составляет 3.1...6.8 
мс для моделей ATtinyl2x и 4.6...8.2 медля модели ATtinyl5L По  
окончании цикла записи разряд EEWE аппаратно сбрасывается, после чего 
программа может начать запись следующего байта. Следует также пом- 
-39- 
