Часть 4. Программирование микроконтроллеров семейств Tiny и Mega 
2. Выждать не менее 20 мс. 
3. Послать на вывод MOSI команду «Разрешение  
программирования». 
Для контроля прохождения команды при посылке 3-го байта 
возвращается значение 2-го байта ($53). Если возвращаемое значе- 
ние отлично от указанного, необходимо подать на вывод RESET 
положительный импульс и снова послать команду «Разрешение 
программирования». Причем независимо от возвращаемого  
значения необходимо передавать все 4 байта команды. Отсутствие  
возврата числа $53 после 32 попыток указывает на отсутствие связи 
между программатором и микросхемой либо на неисправность 
микросхемы. 
После завершения программирования на вывод RESET можно 
подать напряжение ВЫСОКОГО уровня для перевода  
микроконтроллера в рабочий режим, либо выключить его. В последнем  
случае необходимо выполнить следующую последовательность  
действий: 
1. Подать на вывод XTAL1 напряжение НИЗКОГО уровня, если 
тактирование микроконтроллера осуществляется от внешней 
схемы. 
2. Подать на вывод RESET напряжение ВЫСОКОГО уровня. 
3. Отключить напряжение питания от микроконтроллера. 
23.3. Управлением процессом программирования 
FLASH-памяти 
Программирование памяти программ микроконтроллеров  
семейства Tiny осуществляется побайтно путем посылки команд «Запись 
FLASH-памяти». В каждой команде передается адрес изменяемой 
ячейки и записываемое значение. 
Следует помнить, что программирование ячейки можно выполнять 
только после завершения записи предыдущей ячейки. Для  
определения момента окончания записи существует два способа. Первый и 
наиболее универсальный способ — выдерживать между посылкой  
команд паузу, длительностью не меньше /wd_flash (cm- ТЬбл. 4.15).  
Второй способ заключается в контролировании содержимого ячейки  
после посылки команды записи: до завершения записи ячейки при ее 
чтении возвращается значение «$FF», а после завершения —  
записанное значение. 
Программирование памяти программ микроконтроллеров  
семейства Mega осуществляется постранично. Сначала содержимое страницы 
-496- 
