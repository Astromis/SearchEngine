Глава 26. Самопрограммирование 
микроконтроллеров 
семейства Mega 
26.1. Общие сведения 
Все микроконтроллеры семейства Mega имеют возможность  
самопрограммирования, т. е. самостоятельного изменения содержимого 
своей памяти программ. Эта особенность позволяет создавать на их 
основе очень гибкие системы, алгоритм работы которых будет  
меняться самим микроконтроллером в зависимости от каких-либо  
внутренних условий или внешних событий. 
Для поддержки самопрограммирования вся область памяти  
программ логически разделена на две секции — секцию прикладной  
программы (Application Section) и секцию загрузчика (Boot Loader  
Section). Изменение памяти программ осуществляется 
программой-загрузчиком, расположенной в одноименной секции. Для 
загрузки нового содержимого памяти программ, а также для выгрузки 
старого содержимого программа-загрузчик может использовать любой 
интерфейс передачи данных (USART/UART, SPI, TW1), имеющийся в 
составе конкретного микроконтроллера. Сразу отметим, что загрузчик 
может изменять содержимое обеих секций. Это позволяет ему  
модифицировать собственный код и даже удалять себя из памяти, если  
надобность в нем отпадет. Уровень доступа (чтение/запись) к каждой из 
секций задается пользователем с помощью ячеек защиты 
BLB02:BLB01 и BLB12:BLB11, описанных в 1-й главе этой части 
(см. Табл. 4.2). 
Переход к программе-загрузчику может осуществляться различным 
образом. В частности, она может быть вызвана из основной  
программы командами CALL/JMP. Отметим, что в моделях ATmegal61x этот 
способ является единственным. Другим способом является  
перемещение вектора сброса в начало секции загрузчика. В этом случае запуск 
программы-загрузчика будет осуществляться автоматически после  
каждого сброса микроконтроллера. Положение вектора сброса определя- 
-528- 
