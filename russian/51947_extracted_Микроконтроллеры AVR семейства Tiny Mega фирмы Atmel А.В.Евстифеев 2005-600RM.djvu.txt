Часть 2. Микроконтроллеры семейства Mega 
команды осуществлялась передача, сброс разряда произойдет только после 
завершения текущей и отложенной передач, т. е. после очистки сдвигового 
и буферного регистров передатчика. При выключенном передатчике вывод 
TXD (TXDn) может использоваться как контакт ввода/вывода 
общего назначения. 
Ниже приведен простейший пример подпрофаммы передачи по 
интерфейсу USART/UART. Эта подпрограмма ждет очистки буфера 
передатчика, а затем загружает в него новое значение. 
Пример на ассемблере 
USART_Transmit: 
;Ждать очистки буфера передатчика 
sbis UCSRA,UDRE 
rjmp USART_Transmit 
/Скопировать 9-й разряд данных из г17 в ТХВ8 
cbi UCSRB,TXB8 
sbrc rl7,0 
sbi UCSRB,TXB8 
/Загрузить младший байт данных в буфер, начать передачу 
out UDR,rl6 
ret 
Пример на С 
void USART_Transmit(unsigned int data) 
{ 
/* ждать очистки буфера передатчика */ 
while ( !( UCSRA & A«UDRE))) 
/* скопировать 9-й разряд данных из г17 в ТХВ8 */ 
UCSRB &= ~A<<ТХВ8); 
if (data & 0x100) 
UCSRB |= A«TXB8); 
/* загрузить младший байт данных в буфер, начать передачу */ 
UDR = data 
16.2.4. Прием данных 
Работа приемника разрешается установкой разряда RXEN (RXENai)  
регистра UCSRB (UCSR/zB). При установке разрада вывод RXD (RXD«)  
подключается к приемнику USART/UART и начинает функционировать как 
-340- 
