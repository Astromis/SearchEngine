Часть 2. Микроконтроллеры семейства Mega 
ные, которые должны быть помещены в EEPROM, а при чтении в этот  
регистр помещаются данные, считанные из EEPROM. 
Регистр управления 
Регистр управления EEPROM-памяти EECR (EEPROM Control 
Register) расположен по адресу $1С ДОС). Этот регистр используется для 
управления доступом к EEPROM-памяти. Формат этого регистра показан 
на Рис. 2.33, а его описание приведено в Табл. 2.30. 
Рис. 2.33. Формат регистра EECR 
Таблица 2.30. Разряды регистра EECR 
Разряд 
7...4 
3 
2 
1 
0 
Название 
- 
EERIE 
EEMWE 
EEWE 
EERE 
Описание 
Не используются, читаются как «0» 
Разрешение прерывания от EEPROM.3tot разряд управляет генерацией 
прерывания, возникающего при завершении цикла записи в EEPROM. Если 
этот разряд установлен в «1», прерывания разрешены (если флаг I регистра 
SREG также установлен в «1»). При сброшенном разряде EEWE (см. далее в 
таблице) прерывание генерируется постоянно 
Управление разрешением записи в EEPROM .Состояние этого разряда  
определяет функционирование флага разрешения записи EEWE. Если данный разряд  
установлен в «1», то при записи в разряд EEWE «1» происходит запись данных в 
EEPROM. В противном случае установка EEWE в «1» не производит никакого  
эффекта. После программной установки разряд EEMWE сбрасывается аппаратно через 
4 машинных цикла 
Разрешение записи в EEPROM.ITpH установке этого разряда в «1»  
происходит запись данных в EEPROM (если EEMWE равен«1») 
Разрешение чтения из EEPROM.После установки этого разряда в «1»  
выполняется чтение данных из EEPROM. По окончании чтения этот разряд 
сбрасывается аппаратно 
Итак, процедура записи одного байта в EEPROM-память состоит из  
следующих этапов: 
1. Дождаться готовности EEPROM к записи данных (ждать пока не 
сбросится флаг EEWE регистра EECR). 
2. Дождаться завершения записи во FLASH-память программ 
(ждать пока не сбросится флаг SPMEN регистра SPMCR). 
3. Загрузить байт данных в регистр EEDR, а требуемый адрес — в 
регистр EEAR (при необходимости). 
4. Установить в «1» флаг EEMWE регистра EECR. 
-190- 
