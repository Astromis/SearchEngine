Глава ^.Последовательный двухпроводным интерфейс 
подтверждение (АСК), несмотря на то что ведомый передатчик передал 
последний байт и ожвдал сигнала NACK. 
Прием своего 
адреса и передача 
одного или более 
байт данных 
Потеря приоритета 
в режиме ведущего и 
адресация в качестве 
ведомого 
Передан последний байт. 
Переключение в режим 
неадресованного 
ведущего (TWEA = «О») 
S — состояние СТАРТ 
Rs — состояние ПОВСТАРТ 
Р — состояние СТОП 
R —запрос на чтение («1») 
W — запрос на запись («О») 
А — бит подтверждения («О») 
А —бит неподтверждения («1») 
SLA — адрес ведомого устройства 
DATA — байт данных 
От ведущего к ведомому 
От ведомого к ведущему 
Один или несколько байт данных 
с соответствующими битами подтверждения 
- момент установки флага TWINT, где 
п — код статуса в регистре TWSR 
Рис. 2.126. Состояния модуля TWI в режиме «Ведомый передатчик» 
После перехода в любое из указанных состояний модуль TWI будет 
игнорировать обращения к нему ведущего. Соответственно, если ведущий 
будет продолжать обмен по шине, он будет постоянно принимать 
значение «1». Обработка адресных пакетов при сброшенном разряде TWEA 
также прекращается, но может быть возобновлена в любой момент времени 
повторной установкой этого разряда. 
18.5.5. Комбинирование различных режимов 
На практике для выполнения какой-либо операции по шине TWI  
каждому устройству приходится использовать несколько режимов,  
переключаясь между ними при необходимости. В качестве примера рассмотрим  
операцию чтения данных из внешнего EEPROM. 
Все операции такого рода можно разбить на четыре этапа: 
1) инициирование обмена; 
2) передача адреса, по которому требуется прочитать данные; 
3) выполнение чтения; 
4) завершение передачи. 
-385- 
