Глава 17.Последовательный периферийный интерфейс SPI 
При включенном модуле SPI режим работы указанных выводов 
(направление передачи данных) переопределяется согласно Табл. 2.133. 
Направление передачи данных определяется состоянием  
соответствующего разряда регистра DDRB. 
Таблица 2.133. Переназначение режима работы выводов модуля SPI 
Вывод 
MOSI 
MISO 
SCK 
55 
Режим «Master» 
Определяется пользователем 
Вход 
Определяется пользователем 
Определяется пользователем 
Режим «Slave» 
Вход 
Определяется пользователем 
Вход 
Вход 
Как видно из таблицы, в определенных случаях пользователь должен  
самостоятельно задать режим работы вывода, используемого модулем SPI, в 
соответствии с его назначением (см. далее). При этом возможность  
управления внутренними подтягивающими резисторами выводов, работающих как 
входы, сохраняется независимо от способа управления их режимом работы. 
Для управления модулем SPI предназначен регистр управления SPCR, 
расположенный по адресу $0D ($2D). Формат этого регистра приведен на 
Рис. 2.105, а краткое описание функций разрядов регистра приведено в 
Ткбл. 2.134. Подробно использование различных разрядов регистра будет 
описано далее. 
Рис. 2.105. Формат регистра SPCR 
Таблица 2.134. Разряды регистра SPCR 
Разряд 
7 
6 
5 
4 
3 
2 
1,0 
Название 
SPIE 
SPE 
DORD 
MSTR 
CPOL 
СРНА 
SPR1:SPRO 
Описание 
Разрешение прерывания от SPI 
Включение/выключение SPI 
Порядок передачи данных 
Выбор режима работы («Master»/«Slave») 
Полярность тактового сигнала 
Фаза тактового сигнала 
Скорость передачи 
Контроль состояния модуля, а также дополнительное управление  
скоростью обмена осуществляется с помощью регистра состояния SPSR, распо- 
-349- 
