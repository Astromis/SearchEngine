Часть 2. Микроконтроллеры семейства Mega 
При распознавании ведомым своего адреса он должен сформировать 
подтверждение путем выдачи на линию SDA сигнала НИЗКОГО уровня 
вовремя 9-го тактового импульса (АСК). Если ведомый по каким-либо 
причинам не может обслужить запрос ведущего, он должен во время 9-го 
тактового импульса удерживать на линии сигнал ВЫСОКОГО уровня 
(NACK). 
Ведомым устройствам могут быть назначены любые адреса за  
исключением нулевого адреса и адресов из диапазона «1111000... 1111111». Нулевой 
адрес зарезервирован для реализации так называемых общих вызовов, а 
адреса формата «111 lxxx» должны быть зарезервированы для использования 
в дальнейшем. 
Общий вызов используется, когда ведущий хочет передать всем  
ведомым, подключенным к шине, одно и то же сообщение. При приеме  
адресного пакета с нулевым адресом и сброшенным управляющим битом (запрос 
на передачу) все ведомые устройства, подключенные к шине, должны  
сформировать подтверждение. Исключение составляют лишь те устройства, 
в которых распознавание общего вызова по каким-либо причинам  
запрещено. Соответственно, последующие пакеты данных, посылаемые  
ведущим, будут получены всеми ведомыми устройствами, распознавшими адрес 
общего вызова. 
Очевидно, что общий вызов с установленным управляющим разрядом 
(запрос на чтение) не имеет смысла, поскольку различные устройства 
не могут одновременно осуществлять передачу данных по шине. 
Формат пакета данных 
Все пакеты данных, передаваемые по шине TWI, тоже имеют длину 
9 бит. Пакет состоит из байта данных (первым передается старший разряд) и 
бита квитирования АСК (Рис. 2.116). Генерация тактового сигнала и  
формирование состояний СТАРТ и СТОП осуществляется ведущим.  
Приемник, в свою очередь, должен после приема каждого байта формировать  
подтверждение (АСК) путем выдачи на линию SDA сигнала НИЗКОГО уровня 
во время 9-го тактового импульса. Если приемник получил последний байт 
или по каким-либо другим причинам не может продолжать прием данных, 
он должен во время 9-го тактового импульса удерживать на линии сигнал 
ВЫСОКОГО уровня (NACK). Не получив подтверждения от приемника, 
ведущий может прекратить передачу данных, сформировав состояние 
СТОП. 
На практике каждый цикл обмена по шине TWI состоит из следующих 
этапов (Рис. 2.117): 
-360- 
