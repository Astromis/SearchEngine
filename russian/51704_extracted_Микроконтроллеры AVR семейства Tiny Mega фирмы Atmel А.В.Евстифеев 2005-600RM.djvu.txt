Часть 1. Микроконтроллеры семейства Tiny 
5.4.2. Режим таймера 
Принцип работы таймера/счетчика Т1 в этом режиме такой же, что 
и таймера/счетчика ТО. По каждому импульсу, поступающему на  
тактовый вход таймера/счетчика, производится инкремент содержимого 
счетного регистра TCNT1. При переходе таймера/счетчика из  
состояния «$FF» в состояние «$00» устанавливается флаг TOV1 регистра 
TIFR и генерируется запрос на прерывание. Разрешение прерывания 
осуществляется установкой в «1» разряда TOIE1 регистра TIMSK. 
При каждом изменении счетного регистра осуществляется  
сравнение его содержимого с числом, находящемся в регистре сравнения 
OCR1 А. При совпадении содержимого этих регистров устанавливается 
флаг OCF1A регистра TIFR и генерируется запрос на прерывание.  
Разрешение прерывания осуществляется установкой в «1» разряда 
OCIE1A регистра TIMSK. Помимо генерации прерывания при  
равенстве счетного регистра и регистра сравнения могут выполняться также 
сброс таймера/счетчика или изменение состояния вывода РВ1 (ОС1А) 
микроконтроллера. 
Поведение микроконтроллера, т. е. выполнение или невыполнение 
указанных действий, определяется состоянием разрядов регистра 
управления TCCR1. Описание этих разрядов приведено в Табл. 1.42. 
Таблица 1.42. Управление работой схемы сравнения таймера/счетчика Т1 
Разряд 
7 
5,4 
Название 
СТС1 
СОМ1А1, 
СОМ 1 АО 
Описание 
Сброс таймера/счетчика. Если этот разряд установлен в «1», то при  
совпадении содержимого счетного регистра и регистра сравнения OCR1A  
производится сброс таймера/счетчика в состояние «$00» 
Управление выводом РВ1 (ОС1А)*. Состояние этих разрядов определяет поведение 
вывода РВ1 (ОС1А) при совпадении содержимого счетного регистра и регистра 
сравнения OCR1A При изменении состояния этих разрядов соответствующее 
прерывание от компаратора таймера/счетчика рекомендуется запретить (во  
избежание ложной генерации прерывания). Чтобы таймер/счетчик мог управлять этим 
выводом, последний должен быть сконфигурирован как выходной Поведение  
вывода задается следующим образом: 
СОМ1А1 
0 
0 
1 
1 
СОМ 1 АО 
0 
1 
0 
1 
Описание 
Таймер/счетчик отключен от вывода РВ1 
Состояние вывода меняется на  
противоположное 
Вывод сбрасывается в «0» 
Вывод устанавливается в «1» 
* В режиме ШИМ эти разряды имеют другие функции (Табл. 1.43) 
-94- 
