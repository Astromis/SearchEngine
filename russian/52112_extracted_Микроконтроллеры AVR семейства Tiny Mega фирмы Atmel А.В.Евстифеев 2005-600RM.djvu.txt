Глава 24. Параллельное программирование 
4. Перепрограммировать ячейку RSTDISBL (если установлена 
защита, то сначала необходимо выполнить стирание кристалла). 
5. Выйти из режима программирования (отключить питание или 
подать на вывод RESET напряжение ВЫСОКОГО уровня). 
6. Перевести микроконтроллер в режим программирования, как 
было описано ранее. 
24.3. Стирание кристалла 
Команда «Стирание кристалла» должна выполняться перед каждым 
перепрограммированием микроконтроллера. Данная команда  
полностью уничтожает содержимое FLASH- и EEPROM-памяти, а затем 
сбрасывает ячейки защиты (записывает в них «1»). Однако на  
состояние конфигурационных ячеек данная команда не влияет. Кроме того, 
в ряде моделей микроконтроллеров семейства Mega, можно  
предотвратить стирание EEPROM-памяти путем программирования  
конфигурационной ячейки EESAVE. 
Для выполнения команды «Стирание кристалла» необходимо  
выполнить следующие действия: 
1. Загрузить команду «Стирание кристалла» (код «1000 0000»). 
2. Подать на вывод WR отрицательный импульс; при этом на  
выводе RDY/BSY появляется сигнал НИЗКОГО уровня. 
3. Ждать появления на выводе RDY/BSY сигнала ВЫСОКОГО 
уровня. 
24.4. Программирование FLASH-памяти 
Запись FLASH-памяти 
Сразу отметим, что алгоритм записи во FLASH-память зависит 
от семейства. Это связано с тем, что в семействе Tiny запись 
FLASH-памяти производится побайтно, а в семействе Mega —  
постранично. 
Итак, в семействе Tiny запись FLASH-памяти производится в  
следующей последовательности (реализация каждого этапа приведена 
в Табл. 4.20): 
1. Загрузить команду «Запись FLASH-памяти» (код «0001 0000»). 
2. Загрузить старший байт адреса. 
3. Загрузить младший байт адреса. 
4. Загрузить младший байт данных. 
5. Записать младший байт данных. 
-505- 
