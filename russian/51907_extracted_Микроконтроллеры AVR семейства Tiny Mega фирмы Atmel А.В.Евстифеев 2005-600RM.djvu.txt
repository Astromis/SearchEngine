Часть 2. Микроконтроллеры семейства Mega 
Частота генерируемого сигнала foo\~fdk i/c/BW TOP), где TOP — 
модуль счета, а N — коэффициент деления предделителя, приведенный 
в Табл. 2.80. 
13.6.3.5. Режим Phase and Frequency Correct PWM 
Режим Phase and Frequency Corect PWM («ШИМ с точной фазой и  
частотой»), отсутствующий в моделях ATmegal61x/163x/323x, очень похож на 
режим Phase Corect PWM. Единственная принципиальная разница между 
ними — момент обновления содержимого регистра сравнения. 
Максимальное значение счетчика (разрешение ШИМ-сигнала) в этом 
режиме может определяться только регистрами ICR1A (ICR3A) или OCR1А 
(OCR3A) таймера/счетчика Tl (T3), как показано в Табл. 2.101.  
Разрешающая способность определяется выражением R = logGD/)+ l)/log2, где 
ТОР — модуль счета. 
Таблица 2.101. Разрешающая способность модулятора в режиме Phase and 
frequency Correct PWM 
Номер 
режима 
8 
9 
WGM/i3 
1 
1 
WGM/i2 
0 
0 
WGM/il 
1 
1 
WGM/iO 
0 
1 
Разрешающая 
способность 
Переменная B... 16) 
Переменная B...16) 
Модуль счета 
(ТОР) 
ICRM 
($0003...$FFFF) 
OCRM 
($0003...$FFFF) 
Примечания: п = 1 для таймера/счетчика Т1, п = 3 для таймера/счетчика ТЗ. 
Как и в остальных режимах, при работе с какими-либо  
фиксированными значениями модуля счета, для задания его рекомендуется использовать 
регистр захвата. При этом регистр OCR1A (OCR3A) может использоваться 
для формирования ШИМ-сигнала. Если же в процессе формирования 
ШИМ-сигнала его частота меняется очень часто, для задания модуля счета 
рекомендуется использовать регистр сравнения. 
При достижении счетчиком максимального значения происходит смена 
направления счета, но счетчик остается в этом состоянии в течение одного 
периода сигнала clkT, (clkT3). В этом же такте устанавливается флаг ICFn  
либо OCFazA (зависит от того, какой из регистров используется для задания 
модуля счета). 
При достижении счетчиком минимального значения ($0000)  
направление счета опять изменяется. При этом устанавливается флаг прерывания 
TOV1 (TOV3) регистра TIFR (ETIFR) и производится обновление  
содержимого регистра сравнения. 
При равенстве содержимого счетного регистра и какого-либо регистра 
сравнения устанавливается соответствующий флаг OCF1A/OCF1B/OCF1C 
-298- 
