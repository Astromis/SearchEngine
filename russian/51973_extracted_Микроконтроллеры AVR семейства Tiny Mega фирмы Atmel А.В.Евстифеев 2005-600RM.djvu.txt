Часть 2. Микроконтроллеры семейства Mega 
Формат регистра TWCR показан на Рис. 2.120, а описание его разрядов 
приведено в Табл. 2.142. Формат регистра TWSR показан на Рис. 2.121, 
а описание его разрядов приведено в Табл. 2.143. 
Рис. 2.120. Формат регистра TWCR 
Таблица 2.142. Разряды регистра управления TWCR 
7 
6 
5 
4 
3 
2 
1 
0 
 
Название 
TWINT 
TWEA 
TWSTA 
TWSTO 
TWWC 
TWEN 
- 
TWIE 
Описание 
Флаг прерывания от модуля TW1 Этот флаг устанавливается аппаратно после  
выполнения очередной операции, когда модуль ожидает отклика со стороны  
программы. Если установлены флаги I регистра SREG и TWIE регистра TWCR, генерируется 
прерывание и осуществляется вызов соответствующего обработчика. Пока флаг 
TWINT установлен, на линии SCL удерживается сигнал НИЗКОГО уровня. Сброс 
флага может быть осуществлен только записью в него лог. 1 
Разрешение бита подтверждения. Разряд TWEA управляет формированием бита 
подтверждения. Если этот разряд установлен в «1», то устройство формирует сигнал 
подтверждения, когда это необходимо. При сбросе разряда в «0» устройство  
виртуально отключается от шины TWI, т. е. бит подтверждения не формируется 
Флаг состояния СТАРТ. При записи в разряд TWSTA лог. 1 модуль проверяет  
состояние шины TWI и, если шина свободна, формирует состояние СТАРТ. Если шина 
занята, модуль TWI ожидает появления состояния СТОП, и только после этого  
формирует состояние СТАРТ. Флаг сбрасывается аппаратно по окончании  
формирования состояния СТАРТ 
Флаг состояния СТОП. В режиме ведущего установка флага TWSTO в «1» приводит 
к формированию на шине состояния СТОП. Флаг сбрасывается аппаратно по  
окончании формирования состояния СТОП. Установка флага TWSTO в режиме ведомого 
может использоваться для выхода из ошибочных ситуаций. После записи в этот  
разряд лог. 1 модуль TWI возвращается в режим неадресованного ведомого, а выводы 
SCL и SDA устанавливаются в третье состояние. Состояние СТОП не формируется 
Флаг конфликта записи. Флаг устанавливается в «1» при попытке записи в регистр 
TWDR, когда флаг прерывания TWINT сброшен. Флаг сбрасывается при записи 
в регистр TWDR, когда флаг прерывания TWINT установлен 
Разрешение работы модуля TWI. Разряд TWEN управляет функционированием 
модуля TWI. При записи в этот разряд лог. 1 модуль TWI включается и берет на себя 
управление контактами ввода/вывода микроконтроллера, соответствующих  
выводам SCL и SDA. При сбросе разряда TWEN в 0 модуль TWI выключается 
Зарезервирован, читается как «0» 
Разрешение прерывания от модуля TWI. Если в этом разряде записана лог. 1 
и флаг I регистра SREG также установлен в «1», то прерывание от модуля 
TWI разрешено 
-366- 
