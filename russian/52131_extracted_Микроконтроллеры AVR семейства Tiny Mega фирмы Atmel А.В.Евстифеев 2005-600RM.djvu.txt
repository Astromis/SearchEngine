Часть 4. Программирование микроконтроллеров семейств Tiny и Mega 
Ниже приведен порядок выполнения 12 операций. 
Операция «Вход в режим программирования»: 
1. Загрузить команду AVRRESET и занести «1» в регистр сброса. 
2. Загрузить команду PROG_ENABLE и занести в регистр  
разрешения программирования значение 10100011 0111_0000 ($А370). 
Операция «Выход из режима программирования»: 
1. Загрузить команду PROG_COMMANDS. 
2. Запретить выполнение всех команд программирования, запустив 
команду «Нет операции» A1а). 
3. Загрузить команду PROG_ENABLE и занести в регистр  
разрешения программирования значение 0000_0000_0000_0000. 
4. Загрузить команду AVRRESET и занести «0» в регистр 
сброса. 
Операция «Стирание кристалла»: 
1. Загрузить команду PROG_COMMANDS. 
2. Начать стирание кристалла, запустив команду 1а. 
3. Дождаться окончания выполнения этой операции, контролируя 
значение, возвращаемое командой 1Ь. В качестве альтернативы 
можно просто выждать время /wlrh се (см- Табл. 4.19). 
Операция «Программирование FLASH-памяти»: 
1. Загрузить команду PROG_COMMANDS. 
2. Войти в режим программирования FLASH-памяти (команда 2а). 
3. Загрузить старший байт адреса (команда 2Ь). 
4. Загрузить младший байт адреса (команда 2с). 
5. Загрузить данные (команды 2d, 2e и 2f). 
6. Повторить п.п. 4 и 5 для каждой ячейки страницы памяти  
программ. 
7. Записать страницу (команда 2g). 
8. Дождаться окончания выполнения этой операции, контролируя 
значение, возвращаемое командой 2h. В качестве альтернативы 
можно просто выждать время Jwlrh (cm. Табл. 4.19). 
9. Повторить пп. 3...8 для программирования остальных страниц 
памяти программ. 
Существует также другой, более эффективный способ загрузки  
данных в микроконтроллер, основанный на использовании команды 
PROG_PAGELOAD: 
1. Загрузить команду PROG_COMMANDS. 
2. Войти в режим программирования FLASH-памяти (команда 2а). 
-524- 
