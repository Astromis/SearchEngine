Часть 2. Микроконтроллеры семейства Mega 
Абсолютный вызов подпрограммы — команда CALL 
При выполнении команды после сохранения в стеке текущего значения 
счетчика команд в последний загружается число, являющееся операндом 
команды (Рис. 2.36). С помощью этой команды можно осуществлять вызов 
в пределах всего адресного пространства имеющихся на сегодняшний день 
микроконтроллеров AVR. 
Команда абсолютного вызова подпрограмм выполняется за 4 машинных 
цикла. 
Косвенный вызов подпрограммы — команда ICALL 
Команда ICALL сначала сохраняет в стеке значение счетчика  
команд. Затем в счетчик команд загружается содержимое индексного 
регистра. Максимально возможная величина перехода составляет 
64К слов A28 Кбайт), поэтому данная команда также не имеет  
ограничений по области действия. 
Как и команда RCALL, команда косвенного вызова подпрограмм  
выполняется за 3 машинных цикла. 
9.3.7. Команды возврата из подпрограмм 
В конце каждой подпрограммы обязательно должна находиться команда 
возврата из нее. В системе команд микроконтроллеров семейства имеется 
две таких команды. Для возврата из обычной подпрограммы, вызываемой 
командой RCALL, используется команда RET. Для возврата из  
подпрограммы обработки прерывания используется команда RETI. 
Обе команды восстанавливают из стека содержимое счетчика команд, 
сохраненное там перед переходом к подпрограмме. Команда возврата из 
подпрограммы RETI дополнительно устанавливает в «1» флаг общего  
разрешения прерываний I регистра SREG, сбрасываемый аппарат™ при  
возникновении прерывания. 
На выполнение каждой из команд возврата из подпрограммы требуется 
4 машинных цикла. 
9.4. Стек 
Во всех микроконтроллерах семейства Mega стек реализован  
программно. Он размещается в памяти данных, и его глубина определяется только 
размером свободной области памяти программ. В качестве указателя стека 
во всех моделях используется пара регистров ввода/вывода SPH:SPL,  
расположенных по адресам $ЗЕ ($5Е) и $3D ($5D) соответственно. Так как после 
подачи напряжения питания (или после сброса) в регистрах содержится ну- 
—198 — 
