Часть 1. Микроконтроллеры семейства Tiny 
нить, что после установки разряда EEWE в «1», процессор пропускает 2 
машинных цикла перед выполнением следующей инструкции. 
При записи в EEPROM могут возникнуть некоторые проблемы, 
вызванные прерываниями. При возникновении прерывания между 
3-м и 4-м этапами описанной последовательности запись в EEPROM 
будет сорвана, т. к. за время обработки прерывания флаг EEMWE  
сбросится в «О». Если в подпрограмме обработки прерывания, возникшего 
во время записи в EEPROM-память, также происходит обращение 
к ней, то будет изменено содержимое регистров адреса и данных 
EEPROM. В результате первая запись (прерванная) будет сорвана. 
Для избежания описанных проблем настоятельно рекомендуется 
запрещать все прерывания (сбрасывать бит I регистра SREG) при  
выполнении пунктов 2...4 описанной выше последовательности! 
С учетом сказанного фрагмент программы, осуществляющий  
запись в EEPROM, выглядит следующим образом: 
EEWnte: 
sbic EECR,EEWE ;Ждать,пока флаг 
rjmp EEWnte ;EEWE не будет сброшен 
cli /Запретить прерывания 
out EEAR,AddrReg ;Загрузить адрес 
;(AddrReg - РОН) 
out EEDR,DataReg /Загрузить данные 
;(DataReg - РОН) 
sbi EECR,EEMWE 
sbi EECR,EEWE ;Выдать строб записи 
;в EEPROM 
sei /Разрешить прерывния 
;(если необходимо) 
Процедура чтения данных из EEPROM гораздо проще, чем  
процедура записи. После загрузки требуемого адреса в регистр EEAR,  
программа должна установить разряд EERE регистра EECR в «1». Когда 
запрошенные данные будут находиться в регистре данных EEDR,  
произойдет аппаратный сброс этого разряда. 
Операция чтения из EEPROM всегда выполняется за один  
машинный цикл. Кроме того, после установки разряда EERE в «1»  
процессор пропускает 4 машинных цикла перед началом выполнения 
следующей инструкции. Поэтому следить в программе за состоянием 
разряда EERE нет никакой необходимости. 
Единственное, на что нужно обратить внимание при чтении из 
EEPROM, это состояние флага EEWE. Перед выполнением чтения 
необходимо убедиться, что этот флаг сброшен. В противном случае в 
-40- 
